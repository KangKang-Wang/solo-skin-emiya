/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/main/resources/skins/emiya/js/common.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/main/resources/skins/emiya/js/common.js":
/*!*****************************************************!*\
  !*** ./src/main/resources/skins/emiya/js/common.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/*\r\n * Solo - A beautiful, simple, stable, fast Java blogging system.\r\n * Copyright (c) 2010-2018, b3log.org & hacpai.com\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Affero General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Affero General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\r\n */\r\n/**\r\n * @fileoverview util and every page should be used.\r\n *\r\n * @author <a href=\"http://vanessa.b3log.org\">Liyuan Li</a>\r\n * @version 0.1.0.0, Feb 17, 2017\r\n */\r\n\r\n/**\r\n * @description 皮肤脚本\r\n * @static\r\n */\r\nconst scrollTo = (to) => {\r\n  $('html ,body').animate({\r\n    scrollTop: to,\r\n  }, 300);\r\n}\r\n\r\nconst $navBar = $('.J_navbar')\r\nconst $backToTop = $('.toTop')\r\nconst $contents = $('.J_article__contents')\r\n\r\nclass ScrollManager {\r\n  constructor() {\r\n    this.showBackToTopHeight = 100\r\n    this.prevScrollY = $(window).scrollTop()\r\n    this.scrollY = $(window).scrollTop()\r\n    this.contentsStaticTop = $('.J_article__contents').prev().offset().top + $('.J_article__contents').prev().height()\r\n    this.isContentsFixed = false\r\n    this.listen()\r\n    this.calculate()\r\n  }\r\n\r\n  checkNavbarFixed() {\r\n    const navBarHeight = $navBar.height() + 1\r\n    // 在顶端\r\n    if (this.scrollY <= 0) {\r\n      $navBar.removeClass('is-fixed').css('top', 0)\r\n      return\r\n    }\r\n\r\n    $navBar.addClass('is-fixed').css('top', -1 * navBarHeight)\r\n\r\n    if (this.scrollY < this.prevScrollY) {\r\n      $navBar.addClass('show')\r\n    } else {\r\n      $navBar.removeClass('show')\r\n    }\r\n  }\r\n\r\n  checkBackToTop() {\r\n    if(this.scrollY > this.showBackToTopHeight) {\r\n      $backToTop.fadeIn()\r\n    } else {\r\n      $backToTop.fadeOut()\r\n    }\r\n  }\r\n\r\n  checkContents() {\r\n    const $article = $('.J_article__content')\r\n    if ($article.length <= 0) {\r\n      return\r\n    }\r\n\r\n    const navBarHeight = $navBar.height()\r\n    const articleBottom = $article.offset().top + $article.height()\r\n    const contentsBottom = this.scrollY + navBarHeight + $contents.height()\r\n\r\n    if (contentsBottom >= articleBottom && this.isContentsFixed) {\r\n      $contents.css({\r\n        'position': 'absolute',\r\n        'top': articleBottom - $contents.height(),\r\n      })\r\n      this.isContentsFixed = false\r\n      return\r\n    }\r\n\r\n    if (this.scrollY + navBarHeight <= this.contentsStaticTop) {\r\n      $contents.css({\r\n        'position': 'static',\r\n        'top': 0,\r\n      });\r\n      this.isContentsFixed = false\r\n      return\r\n    }\r\n\r\n    if (this.scrollY + navBarHeight > this.contentsStaticTop && contentsBottom < articleBottom) {\r\n      $contents.css({\r\n        'position': 'fixed',\r\n        'top': navBarHeight,\r\n      })\r\n      this.isContentsFixed = true\r\n      return\r\n    }\r\n  }\r\n\r\n  checkContentsHighlight() {\r\n    const offsetTop = $navBar.height() + 1\r\n    const $contentLink = $('.J_article__contents--container a')\r\n    let nowIndex\r\n\r\n    for (let i = 0; i < $contentLink.length; i++) {\r\n      const target = $contentLink.eq(i).attr('data-target')\r\n      if (this.scrollY + offsetTop > $(target).offset().top) {\r\n        nowIndex = i\r\n      }\r\n    }\r\n\r\n    $contentLink.removeClass('active')\r\n    $contentLink.eq(nowIndex).addClass('active')\r\n  }\r\n\r\n  calculate() {\r\n    this.checkNavbarFixed()\r\n    this.checkBackToTop()\r\n    this.checkContents()\r\n    this.checkContentsHighlight()\r\n  }\r\n\r\n  listen() {\r\n    $(window).on('scroll', () => {\r\n      this.prevScrollY = this.scrollY\r\n      this.scrollY = $(window).scrollTop()\r\n      this.calculate()\r\n    });\r\n  }\r\n}\r\n\r\nclass Emiya {\r\n  constructor() {\r\n    this.listen()\r\n  }\r\n\r\n  initPageShare() {\r\n    const $wechatShare = $('.J_share_wechat')\r\n    const shareURL = $wechatShare.data('url')\r\n    const avatarURL = $wechatShare.data('avatar')\r\n    const title = encodeURIComponent(`${$wechatShare.data('title')} - ${$wechatShare.data('blogtitle')}`)\r\n    const url = encodeURIComponent(shareURL)\r\n\r\n    return {\r\n      weibo: `http://v.t.sina.com.cn/share/share.php?title=${title}&url=${url}&pic=${avatarURL}`,\r\n      qzone: `https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${url}&sharesource=qzone&title=${title}&pics=${avatarURL}`,\r\n      wechat: shareURL,\r\n    }\r\n  }\r\n\r\n  initContents() {\r\n    const priorities = {\r\n      h1: 5,\r\n      h2: 4,\r\n      h3: 3,\r\n      h4: 2,\r\n      h5: 1,\r\n    };\r\n\r\n    const $titles = this.getArticleTitles();\r\n  \r\n    if ($titles.length === 0) {\r\n      $('.J_article__contents').hide();\r\n      return;\r\n    }\r\n  \r\n    let tpl = '<ul class=\"article__contents\">';\r\n    let prevPriority;\r\n    let firstPriority;\r\n  \r\n    $titles.each(function(index, dom) {\r\n      const priority = priorities[dom.tagName.toLowerCase()];\r\n      const title = $titles.eq(index).text();\r\n      const $item = $('<i><li><a href=\"javascript:void(0);\" data-target=\"#' + $titles.eq(index).attr('id') + '\"></a></li></i>');\r\n      $item.find('a').text(title);\r\n  \r\n      const item = $item.html();\r\n  \r\n      if (!priority) {\r\n        return;\r\n      }\r\n  \r\n      if (!firstPriority) {\r\n        tpl += item;\r\n        firstPriority = priority;\r\n      } else {\r\n        if (priority === prevPriority) {\r\n          tpl += item;\r\n        } else if (priority < prevPriority) {\r\n          tpl += Array(prevPriority - priority).fill('<ul>').join('') + item;\r\n        } else if (priority > prevPriority) {\r\n          tpl += Array(priority - prevPriority).fill('</ul>').join('') + item;\r\n        }\r\n      }\r\n  \r\n      prevPriority = priority;\r\n    });\r\n  \r\n    tpl += Array(firstPriority - prevPriority + 1).fill('</ul>').join('');\r\n\r\n    $('.J_article__contents--container').append(tpl);\r\n  }\r\n\r\n  getArticleTitles() {\r\n    return $('.J_article__content').find('h1,h2,h3,h4,h5,h6');\r\n  }\r\n\r\n  initArticle() {\r\n    $('.J_article__contents').removeClass('fn__none')\r\n    try {\r\n      this.initContents();\r\n    } catch (e) {\r\n      $('.J_article__contents').addClass('fn__none')\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  listen() {\r\n    const self = this\r\n    $('body').on('touchstart', function() { })\r\n    $('body').on(\"click\", '.J_navbar_toggle', function() {\r\n      const targetClass = '.' + $(this).attr('data-for')\r\n      if ($(targetClass).hasClass('show')) {\r\n          $(targetClass).removeClass('show')\r\n      } else {\r\n          $(targetClass).addClass('show')\r\n      }\r\n    })\r\n    $('body').on('click', '.J_replyName', function() {\r\n      const replyName = $(this).attr('data-originalId');\r\n      $('#' + replyName)[0].scrollIntoViewIfNeeded(true);\r\n      $('#' + replyName).addClass('blink');\r\n      setTimeout(function() {\r\n        $('#' + replyName).removeClass('blink');\r\n      }, 3000);\r\n    })\r\n    $('body').on('click', '.J_backToTop', function(e) {\r\n      scrollTo(0);\r\n      e.preventDefault();\r\n    })\r\n    $('body').on('click', '.J_article__contents--container a', function() {\r\n      const target = $(this).attr('data-target');\r\n      const scrollTarget = $(target).offset().top - $('.J_navbar').height() + 1;\r\n      scrollTo(scrollTarget);\r\n    })\r\n    $('body').on('click', '.J_share', function() {\r\n      const shareURLs = self.initPageShare()\r\n      const $qrCode = $('.J_qrcode')\r\n      const $wechatShare = $('.J_share_wechat')\r\n\r\n      const key = $(this).data('type')\r\n      if (!key) {\r\n        return\r\n      }\r\n\r\n      if (key === 'wechat') {\r\n        if (typeof QRious === 'undefined') {\r\n          Util.addScript(Label.staticServePath + '/js/lib/qrious.min.js', 'qriousScript')\r\n        }\r\n        if ($qrCode.css('background-image') === 'none') {\r\n          const width = 120\r\n          const qr = new QRious({\r\n            element: $qrCode[0],\r\n            value: shareURLs['wechat'],\r\n            value: shareURLs['wechat'],\r\n            size: width,\r\n          })\r\n          $qrCode.css('background-image', `url(${qr.toDataURL('image/jpeg')})`)\r\n            .css('height', width)\r\n            .css('width', width)\r\n            .css('bottom', $wechatShare.height())\r\n            .css('background-size', `${width}px ${width}px`)\r\n          $qrCode.slideToggle()\r\n        } else {\r\n          $qrCode.slideToggle()\r\n        }\r\n        return\r\n      }\r\n  \r\n      window.open(shareURLs[key], '_blank', 'top=100,left=200,width=648,height=618')\r\n    })\r\n  }\r\n}\r\n\r\nwindow.scrollManager = new ScrollManager();\r\nwindow.Skin = new Emiya();\r\nUtil.initPjax(() => {\r\n  $('.J_article__contents').addClass('fn__none');\r\n  $('.J_article__contents--container').empty();\r\n});\r\n\n\n//# sourceURL=webpack:///./src/main/resources/skins/emiya/js/common.js?");

/***/ })

/******/ });